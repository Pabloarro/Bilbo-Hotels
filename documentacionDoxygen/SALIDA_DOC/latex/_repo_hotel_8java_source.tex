\doxysection{Repo\+Hotel.\+java}
\hypertarget{_repo_hotel_8java_source}{}\label{_repo_hotel_8java_source}\index{C:/Users/pabloA/Bilbo-\/Hotels/src/main/java/es/deusto/bilboHotels/repository/RepoHotel.java@{C:/Users/pabloA/Bilbo-\/Hotels/src/main/java/es/deusto/bilboHotels/repository/RepoHotel.java}}
\mbox{\hyperlink{_repo_hotel_8java}{Ir a la documentaci√≥n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00001}00001\ \textcolor{keyword}{package\ }es.deusto.bilboHotels.repository;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00003}00003\ \textcolor{keyword}{import}\ es.deusto.bilboHotels.model.Hotel;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00004}00004\ \textcolor{keyword}{import}\ org.springframework.data.jpa.repository.JpaRepository;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00005}00005\ \textcolor{keyword}{import}\ org.springframework.data.jpa.repository.Query;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00006}00006\ \textcolor{keyword}{import}\ org.springframework.data.repository.query.Param;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00007}00007\ \textcolor{keyword}{import}\ org.springframework.stereotype.Repository;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00009}00009\ \textcolor{keyword}{import}\ java.time.LocalDate;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00010}00010\ \textcolor{keyword}{import}\ java.util.List;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00011}00011\ \textcolor{keyword}{import}\ java.util.Optional;}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00013}00013\ @Repository}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00014}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel}{00014}}\ \textcolor{keyword}{public}\ \textcolor{keyword}{interface\ }\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel}{RepoHotel}}\ \textcolor{keyword}{extends}\ JpaRepository<Hotel,\ Long>\ \{}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00016}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a45dc826dcb427bdfbad30a7e618ce9f5}{00016}}\ \ \ \ \ Optional<Hotel>\ \mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a45dc826dcb427bdfbad30a7e618ce9f5}{findByNombre}}(String\ nombre);}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00018}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a3bb0c9f70265df2af83ce8fa2c7de189}{00018}}\ \ \ \ \ List<Hotel>\ \mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a3bb0c9f70265df2af83ce8fa2c7de189}{findAllByHotelManager\_Id}}(Long\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00020}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_ab0c5e656fde4f5668f25347db81b821d}{00020}}\ \ \ \ \ Optional<Hotel>\ \mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_ab0c5e656fde4f5668f25347db81b821d}{findByIdAndHotelManager\_Id}}(Long\ \textcolor{keywordtype}{id},\ Long\ managerId);}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00022}00022\ \ \ \ \ @Query(\textcolor{stringliteral}{"{}SELECT\ h\ FROM\ Hotel\ h\ WHERE\ h.direccion.ciudad\ =\ :ciudad"{}})}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00023}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a88a85922fc836f9441f1d9795e958926}{00023}}\ \ \ \ \ List<Hotel>\ \mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a88a85922fc836f9441f1d9795e958926}{findHotelsByCity}}(@Param("{}ciudad"{})\ String\ ciudad);}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00025}00025\ \ \ \ \ @Query("{}SELECT\ h\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \ \ \ "{}FROM\ Hotel\ h\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ "{}JOIN\ h.habitaciones\ r\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00028}00028\ \ \ \ \ \ \ \ \ \ \ \ \ "{}LEFT\ JOIN\ Disponibilidad\ a\ ON\ a.habitacion.\textcolor{keywordtype}{id}\ =\ r.\textcolor{keywordtype}{id}\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ "{}AND\ a.fecha\ >=\ :fechaCheckIn\ AND\ a.fecha\ <\ :fechaCheckOut\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ "{}WHERE\ h.direccion.ciudad\ =\ :ciudad\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ "{}AND\ (a\ IS\ NULL\ OR\ a.habitacionesDisponibles\ >\ 0)\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ "{}GROUP\ BY\ h.\textcolor{keywordtype}{id},\ r.\textcolor{keywordtype}{id}\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ "{}HAVING\ COUNT(DISTINCT\ a.fecha)\ +\ SUM(CASE\ WHEN\ a\ IS\ NULL\ THEN\ 1\ ELSE\ 0\ END)\ =\ :numberOfDays"{})}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00034}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_acb6c7d0f18ce8cf18bd8189f64ae2a4f}{00034}}\ \ \ \ \ List<Hotel>\ \mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_acb6c7d0f18ce8cf18bd8189f64ae2a4f}{findHotelsWithAvailableRooms}}(@Param("{}ciudad"{})\ String\ city,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}fechaCheckIn"{})\ LocalDate\ fechaCheckIn,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}fechaCheckOut"{})\ LocalDate\ fechaCheckOut,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}numberOfDays"{})\ Long\ numberOfDays);}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00039}00039\ \ \ \ \ @Query("{}SELECT\ h\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ "{}FROM\ Hotel\ h\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ "{}WHERE\ h.direccion.ciudad\ =\ :ciudad\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ "{}AND\ NOT\ EXISTS\ ("{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ "{}\ \ \ SELECT\ 1\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ "{}\ \ \ FROM\ Disponibilidad\ a\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ "{}\ \ \ WHERE\ a.habitacion.hotel.\textcolor{keywordtype}{id}\ =\ h.\textcolor{keywordtype}{id}\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ "{}\ \ \ AND\ a.fecha\ >=\ :fechaCheckIn\ AND\ a.fecha\ <\ :fechaCheckOut"{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ "{})"{})}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00048}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a9acfc4d5e1771ef91b38e0c3a234f197}{00048}}\ \ \ \ \ List<Hotel>\ \mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a9acfc4d5e1771ef91b38e0c3a234f197}{findHotelsWithoutAvailabilityRecords}}(@Param("{}ciudad"{})\ String\ ciudad,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}fechaCheckIn"{})\ LocalDate\ fechaCheckIn,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}fechaCheckOut"{})\ LocalDate\ fechaCheckOut);}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00052}00052\ \ \ \ \ @Query("{}SELECT\ h\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ "{}FROM\ Hotel\ h\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ "{}JOIN\ h.habitaciones\ r\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ "{}LEFT\ JOIN\ Disponibilidad\ a\ ON\ r.\textcolor{keywordtype}{id}\ =\ a.habitacion.\textcolor{keywordtype}{id}\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ "{}AND\ a.fecha\ >=\ :fechaCheckIn\ AND\ a.fecha\ <\ :fechaCheckOut\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ "{}WHERE\ h.direccion.ciudad\ =\ :ciudad\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ "{}AND\ (a\ IS\ NULL\ OR\ a.habitacionesDisponibles\ >\ 0)\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ "{}GROUP\ BY\ h.\textcolor{keywordtype}{id}\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ "{}HAVING\ COUNT(DISTINCT\ a.fecha)\ <\ :numberOfDays\ "{}\ +}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ "{}AND\ COUNT(DISTINCT\ CASE\ WHEN\ a.habitacionesDisponibles\ >\ 0\ THEN\ a.fecha\ END)\ >\ 0"{})}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00062}\mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a32545599ee314d2d8acca7e72b5b7619}{00062}}\ \ \ \ \ List<Hotel>\ \mbox{\hyperlink{interfacees_1_1deusto_1_1bilbo_hotels_1_1repository_1_1_repo_hotel_a32545599ee314d2d8acca7e72b5b7619}{findHotelsWithPartialAvailabilityRecords}}(@Param("{}ciudad"{})\ String\ ciudad,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}fechaCheckIn"{})\ LocalDate\ fechaCheckIn,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}fechaCheckOut"{})\ LocalDate\ fechaCheckOut,}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @Param("{}numberOfDays"{})\ Long\ numberOfDays);}
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{_repo_hotel_8java_source_l00067}00067\ \}}

\end{DoxyCode}
